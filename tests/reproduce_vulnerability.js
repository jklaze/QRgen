import { getDataFromMode } from '../src/ui-controls.js';

global.document = {
  querySelector: (selector) => {
    if (selector === '.mode-tabs [role="tab"][aria-selected="true"]') {
      return { dataset: { mode: 'vcard' } };
    }
    return null;
  },
  getElementById: (id) => {
    const values = {
      'data-vcard-name': 'John Doe\nORG:Hacker Corp',
      'data-vcard-tel': '123456789',
      'data-vcard-email': 'john@example.com'
    };
    return { value: values[id] || '' };
  }
};

const result = getDataFromMode();
console.log('Resulting vCard:');
console.log(result);

if (result.includes('\nORG:Hacker Corp')) {
  console.log('\nVulnerability confirmed: ORG field injected!');
} else {
  console.log('\nVulnerability not found (or already fixed).');
}
